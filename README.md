# 照片文件筛选与重命名工具

这个工具可以根据照片文件名中的文字或数字片段，与参考表格中的标识符进行匹配，将匹配的文件复制到指定文件夹并按照表格中的备注重命名。

## 功能特点

- 根据文件名中的标识符进行筛选（可为文字或数字）
- 将匹配的文件复制到新的文件夹
- 按照参考表格中的备注信息重命名文件
- 支持Excel(.xlsx/.xls)和CSV(.csv)格式的参考表格
- 保留原始文件的扩展名
- 未找到精确标识符时，支持模糊匹配最接近的标识符

## 安装依赖

在使用此工具前，请确保已安装以下Python库：

```bash
pip install pandas openpyxl
```

## 参考表格格式

参考表格必须包含两列数据：
1. 第一列：标识符（可以是文字或数字）
2. 第二列：对应的备注（将用作新文件名）

示例表格已包含在`example_reference.csv`文件中。

## 使用方法

```bash
python file_filter.py --source <源文件夹路径> --target <目标文件夹路径> --reference <参考表格路径>
```

### 参数说明

- `--source` 或 `-s`：源文件夹路径，包含需要筛选的照片文件
- `--target` 或 `-t`：目标文件夹路径，用于存放筛选后的文件
- `--reference` 或 `-r`：参考表格文件路径，包含标识符和对应的备注

### 使用示例

```bash
python file_filter.py --source /path/to/photos --target /path/to/output --reference example_reference.csv
```

## 注意事项

1. 程序会在文件名中查找文字或数字片段，若未找到则跳过该文件
2. 参考表格中的标识符用于精确或模糊匹配
3. 如果目标文件夹不存在，程序会自动创建
4. 如果目标文件夹中已存在同名文件，将会被覆盖
5. 原始文件不会被删除或修改

## 示例

假设有以下文件：
- 源文件夹：`/photos/IMG_1234.jpg`、`/photos/holiday.png`
- 参考表格：
  ```
  标识符,备注
  1234,北京风景照
  holiday,假日照片
  ```

运行脚本后，目标文件夹将包含：
- `/output/北京风景照.jpg`
- `/output/假日照片.png`
